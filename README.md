# 📊 財務予測シミュレーター

中小企業向けの財務予測・シナリオ分析システムです。弥生会計のデータをインポートし、複数のシナリオで将来の財務状況を予測できます。

## ✨ 主な機能

### 1. 着地予測ダッシュボード
- **KPIサマリーカード**: 売上高、売上総利益、営業利益、経常利益、当期純利益を一目で確認
- **損益計算書**: 実績と予測を統合した期末着地予測
- **グラフ分析**: 月次推移グラフと販売管理費構成比

### 2. 比較分析レポート
- **シナリオ間比較**: 現実・楽観・悲観の3シナリオを比較
- **実績 vs 予測比較**: 当初予測との差異分析

### 3. 全体予測PL & 補助科目入力
- **予測値入力**: 項目別の月次予測値を入力
- **補助科目入力**: 販売管理費の詳細内訳を管理

### 4. 実績データ入力
- 月次実績データの手動入力

### 5. データインポート
- 弥生会計のExcelファイルから自動インポート

### 6. シナリオ一括設定
- 楽観・悲観シナリオの増減率を一括設定

### 7. システム設定
- 会社登録
- 会計期間登録

## 🚀 セットアップ

### 必要要件
- Python 3.9以上

### インストール手順

1. **リポジトリのクローン**
```bash
git clone <repository-url>
cd financial_forecast_simulator
```

2. **依存パッケージのインストール**
```bash
pip install -r requirements.txt
```

3. **アプリケーションの起動**
```bash
streamlit run app.py
```

4. **ブラウザでアクセス**
```
http://localhost:8501
```

## 🔐 ログイン情報

デフォルトの認証情報:
- **パスワード**: admin123

パスワードは `.streamlit/secrets.toml` ファイルで変更できます。

## 📁 ファイル構成

```
financial_forecast_simulator/
├── app.py                      # メインアプリケーション
├── data_processor.py           # データ処理ロジック
├── requirements.txt            # 依存パッケージ
├── config.yaml                 # 認証設定
├── financial_data.db           # SQLiteデータベース（自動生成）
└── README.md                   # このファイル
```

## 📊 データベーススキーマ

### テーブル一覧
- **companies**: 会社マスタ
- **fiscal_periods**: 会計期マスタ
- **actual_data**: 実績データ
- **forecast_data**: 予測データ
- **sub_accounts**: 補助科目
- **item_attributes**: 勘定科目属性

## 💡 使い方

### 1. 初期設定
1. システム設定から会社を登録
2. 会計期間を登録（期数、開始日、終了日）

### 2. データ入力
- **手動入力**: 実績データ入力画面から月次データを入力
- **自動インポート**: 弥生会計のExcelファイルをアップロード

### 3. 予測の作成
1. 全体予測PL画面で将来の予測値を入力
2. 必要に応じて補助科目の内訳を入力

### 4. シナリオ分析
1. シナリオ一括設定で楽観・悲観の増減率を設定
2. サイドバーでシナリオを切り替え
3. 着地予測ダッシュボードで結果を確認

### 5. レポート出力
- 比較分析レポートでシナリオ間の差異を確認
- グラフで視覚的に分析

## 🎨 UIの特徴

- **モダンなデザイン**: グラデーションカードとアイコンを使用
- **直感的な操作**: タブとアコーディオンで情報を整理
- **レスポンシブ**: デスクトップ環境に最適化
- **カラフルなグラフ**: Plotlyによるインタラクティブなグラフ

## 🔧 カスタマイズ

### シナリオ設定の変更
`app.py`の`scenario_rates`を編集してデフォルト値を変更できます:

```python
st.session_state.scenario_rates = {
    "現実": 0.0,    # 0%
    "楽観": 0.1,    # +10%
    "悲観": -0.1    # -10%
}
```

### 勘定科目の追加
`data_processor.py`の`all_items`リストに項目を追加:

```python
self.all_items = [
    "売上高",
    "売上原価",
    # ... 新しい項目を追加
]
```

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 サポート

問題が発生した場合は、GitHubのIssuesでお知らせください。

## 🚀 今後の予定

- [ ] Excel/PDFエクスポート機能
- [ ] メール通知機能
- [ ] ユーザー権限管理
- [ ] 複数期比較機能
- [ ] キャッシュフロー予測
- [ ] AI予測機能

---

**開発者**: Claude
**バージョン**: 1.0.0
**最終更新**: 2024年
